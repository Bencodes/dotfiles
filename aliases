# Dir
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias .....='cd ../../../..'
alias p='pwd'

# Python
alias pweb='python -m SimpleHTTPServer'

# Android
alias l=pidcat
alias logcat=pidcat
alias adb_record="adb shell screenrecord /sdcard/recording.mp4 && adb pull /sdcard/recording.mp4 ~/Desktop/recording.mp4"
alias adb_screencap="adb shell screencap -p /sdcard/screen.png && adb pull /sdcard/screen.png ~/Desktop/screen.png"

# Hub
alias git=hub

# Git
alias gut='git'
alias gl='git pull --prune'
alias glog="git log --graph --pretty=format:'%Cred%h%Creset %an: %s - %Creset %C(yellow)%d%Creset %Cgreen(%cr)%Creset' --abbrev-commit --date=relative"
alias gp=push_and_set_upstream
alias gd='git diff'
alias gc='git commit'
alias gca='git add --all && git commit -a'
alias gco='git checkout'
alias gb='git branch'
alias gs='git status -sb' # upgrade your git if -sb breaks for you. it's fun.
alias ga='git add --all && gs'
alias gf='git fetch --prune'
alias gr='gf && ga && git stash && git pull --rebase && git stash apply'
alias gup='git remote update -p; git merge --ff-only @{u}'
alias gh='git for-each-ref --count=20 --sort=-committerdate refs/heads/ --format="%(refname:short)"'
alias gu='git fetch && git rebase --autostash'
alias pr=pull_request

# Brew
alias bu='brew upgrade && brew update --all && brew cleanup && brew doctor && brew prune'
alias bcu='brew cask doctor && brew cask cleanup'
alias bcuf='brew cask install $(brew cask list | grep java -v | xargs) --force'

# Mainframer
alias m="mainframer"

# Open
alias o='open .'
alias st=source_tree

# Opens the current git repo if it exists
function source_tree() {
  if [[ -d .git ]]; then
    open -a SourceTree $("pwd")
  else
    open -a SourceTree
  fi;
}

function pull_request() {
  push_and_set_upstream
  hub pull-request -o -m $1
}

# Pushes the current branch and sets it to upstream
function push_and_set_upstream() {
  git push -u origin "$(git branch | grep '\*' | cut -d ' ' -f 2)"
}

function shrug() {
  clipboard "¯\_(ツ)_/¯"
}

function mew() {
  FILE=$HOME/.mews
  LINE_COUNT=$(cat $FILE | wc -l)
  RANDOM_LINE=$[$RANDOM % $LINE_COUNT + 1]
  MEW=$(head -$RANDOM_LINE $FILE | tail -1)
  clipboard $MEW
}

function clipboard() {
  if [[ -n $1 ]]; echo $1 | pbcopy
}

function make-mp4() {
  ffmpeg -f gif -i $1 $1.mp4
}

function make-gif() {
  ffmpeg -i $1 -vf fps=10,scale=480:-1 $1.gif
}

function dex-method-count() {
  cat $1 | head -c 92 | tail -c 4 | hexdump -e '1/4 "%d"'
}

function dex-method-count-by-package() {
  dir=$(mktemp -d -t dex)
  baksmali $1 -o $dir
  for pkg in `find $dir/* -type d`; do
    smali $pkg -o $pkg/classes.dex
    count=$(dex-method-count $pkg/classes.dex)
    name=$(echo ${pkg:(${#dir} + 1)} | tr '/' '.')
    echo -e "$count\t$name"
  done
  rm -rf $dir
}
